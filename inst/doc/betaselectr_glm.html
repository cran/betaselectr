<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />


<meta name="date" content="2024-11-08" />

<title>Beta-Select Demonstration: Logistic Regression by glm()</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Beta-Select Demonstration: Logistic
Regression by <code>glm()</code></h1>
<h4 class="date">2024-11-08</h4>



<div id="introduction" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>This article demonstrates how to use <code>glm_betaselect()</code>
from the package <a href="https://sfcheung.github.io/betaselectr/"><code>betaselectr</code></a>
to standardize selected variables in a model fitted by
<code>glm()</code> and forming confidence intervals for the parameters.
Logistic regression is used in this illustration.</p>
</div>
<div id="data-and-model" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Data and Model</h1>
<p>The sample dataset from the package <code>betaselectr</code> will be
used for in this demonstration:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(betaselectr)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">head</span>(data_test_mod_cat_binary)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#&gt;   dv    iv   mod  cov1 cat1</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt; 1  1 16.67 51.76 18.38  gp2</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; 2  1 17.36 56.85 21.52  gp3</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt; 3  1 14.50 46.49 21.52  gp2</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#&gt; 4  0 16.16 48.25 16.28  gp3</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#&gt; 5  0  9.61 42.95 15.89  gp1</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#&gt; 6  0 13.14 48.65 21.03  gp3</span></span></code></pre></div>
<p>This is the logistic regression model, fitted by
<code>glm()</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>glm_out <span class="ot">&lt;-</span> <span class="fu">glm</span>(dv <span class="sc">~</span> iv <span class="sc">*</span> mod <span class="sc">+</span> cov1 <span class="sc">+</span> cat1,</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>               <span class="at">data =</span> data_test_mod_cat_binary,</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">binomial</span>())</span></code></pre></div>
<p>The model has a moderator, <code>mod</code>, posited to moderate the
effect from <code>iv</code> to <code>med</code>. The product term is
<code>iv:mod</code>. The variable <code>cat1</code> is a categorical
variable with three groups: <code>gp1</code>, <code>gp2</code>,
<code>gp3</code>.</p>
<p>These are the results:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">summary</span>(glm_out)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; glm(formula = dv ~ iv * mod + cov1 + cat1, family = binomial(), </span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt;     data = data_test_mod_cat_binary)</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; (Intercept) 24.36566    9.83244   2.478 0.013209 *  </span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; iv          -1.83370    0.67576  -2.714 0.006657 ** </span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; mod         -0.52322    0.19848  -2.636 0.008385 ** </span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; cov1        -0.02286    0.06073  -0.376 0.706562    </span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt; cat1gp2      0.89002    0.36257   2.455 0.014100 *  </span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt; cat1gp3      1.28291    0.34448   3.724 0.000196 ***</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt; iv:mod       0.03815    0.01364   2.797 0.005163 ** </span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 415.03  on 299  degrees of freedom</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 390.91  on 293  degrees of freedom</span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a><span class="co">#&gt; AIC: 404.91</span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span></code></pre></div>
</div>
<div id="problems-with-standardization" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Problems With
Standardization</h1>
<p>In logistic regression, there are several ways to do standardization
<span class="citation">(Menard, 2004)</span>. We use the same approach
in linear regression and standardize all variables, except for the
binary response variable.</p>
<p>First, all variables in the model, including the product term and
dummy variables, are computed:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>data_test_mod_cat_binary_z <span class="ot">&lt;-</span> data_test_mod_cat_binary</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>data_test_mod_cat_binary_z<span class="sc">$</span>iv_x_mod <span class="ot">&lt;-</span> data_test_mod_cat_binary_z<span class="sc">$</span>iv <span class="sc">*</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                                       data_test_mod_cat_binary_z<span class="sc">$</span>mod</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>data_test_mod_cat_binary_z<span class="sc">$</span>cat_gp2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data_test_mod_cat_binary_z<span class="sc">$</span>cat1 <span class="sc">==</span> <span class="st">&quot;gp2&quot;</span>)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>data_test_mod_cat_binary_z<span class="sc">$</span>cat_gp3 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data_test_mod_cat_binary_z<span class="sc">$</span>cat1 <span class="sc">==</span> <span class="st">&quot;gp3&quot;</span>)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="fu">head</span>(data_test_mod_cat_binary_z)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt;   dv    iv   mod  cov1 cat1 iv_x_mod cat_gp2 cat_gp3</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; 1  1 16.67 51.76 18.38  gp2 862.8392       1       0</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; 2  1 17.36 56.85 21.52  gp3 986.9160       0       1</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; 3  1 14.50 46.49 21.52  gp2 674.1050       1       0</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; 4  0 16.16 48.25 16.28  gp3 779.7200       0       1</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; 5  0  9.61 42.95 15.89  gp1 412.7495       0       0</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; 6  0 13.14 48.65 21.03  gp3 639.2610       0       1</span></span></code></pre></div>
<p>All the variables are then standardized:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>data_test_mod_cat_binary_z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">scale</span>(data_test_mod_cat_binary_z[, <span class="sc">-</span><span class="dv">5</span>]))</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>data_test_mod_cat_binary_z<span class="sc">$</span>dv <span class="ot">&lt;-</span> data_test_mod_cat_binary<span class="sc">$</span>dv</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">head</span>(data_test_mod_cat_binary_z)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt;   dv         iv        mod       cov1   iv_x_mod    cat_gp2    cat_gp3</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; 1  1  0.8347403  0.4632131 -0.7895117  0.8142500  1.4553064 -0.9591663</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; 2  1  1.1648852  1.6757589  0.7727941  1.6887948 -0.6848501  1.0390968</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; 3  1 -0.2035415 -0.7922125  0.7727941 -0.5160269  1.4553064 -0.9591663</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; 4  0  0.5907202 -0.3729432 -1.8343660  0.2283915 -0.6848501  1.0390968</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; 5  0 -2.5432642 -1.6355154 -2.0284103 -2.3581688 -0.6848501 -0.9591663</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; 6  0 -0.8542619 -0.2776547  0.5289948 -0.7616218 -0.6848501  1.0390968</span></span></code></pre></div>
<p>The logistic regression model is then fitted to the standardized
variables:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>glm_std_common <span class="ot">&lt;-</span> <span class="fu">glm</span>(dv <span class="sc">~</span> iv <span class="sc">+</span> mod <span class="sc">+</span> cov1 <span class="sc">+</span> cat_gp2 <span class="sc">+</span> cat_gp3 <span class="sc">+</span> iv_x_mod,</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>                      <span class="at">data =</span> data_test_mod_cat_binary_z,</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">binomial</span>())</span></code></pre></div>
<p>The “betas” commonly reported are the coefficients in this model:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>glm_std_common_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(glm_std_common)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">printCoefmat</span>(glm_std_common_summary<span class="sc">$</span>coefficients,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>             <span class="at">digits =</span> <span class="dv">5</span>,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>             <span class="at">zap.ind =</span> <span class="dv">1</span>,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>             <span class="at">P.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>             <span class="at">has.Pvalue =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>             <span class="at">signif.stars =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.11220    0.12083 -0.9284 0.353184    </span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; iv          -3.83240    1.41234 -2.7135 0.006657 ** </span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; mod         -2.19640    0.83316 -2.6362 0.008385 ** </span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; cov1        -0.04600    0.12206 -0.3765 0.706562    </span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; cat_gp2      0.41590    0.16942  2.4547 0.014100 *  </span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; cat_gp3      0.64200    0.17239  3.7242 0.000196 ***</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; iv_x_mod     5.41270    1.93542  2.7967 0.005163 ** </span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>However, for this model, there are several problems:</p>
<ul>
<li><p>The product term, <code>iv:mod</code>, is also standardized
(<code>iv_x_mod</code>, computed using the standard deviations of
<code>dv</code> and <code>iv:mod</code>). This is inappropriate. One
simple but underused solution is standardizing the variables
<em>before</em> forming the product term <span class="citation">(see
Friedrich, 1982 on the case of linear regression)</span>.</p></li>
<li><p>The default confidence intervals are formed using profiling in
<code>glm()</code>. It does allow for asymmetry. However, it does not
take into account the sampling variation of the standardizers (the
sample standard deviations used in standardization). It is unclear
whether it will be biased, as in the case of OLS standard error <span class="citation">(Yuan &amp; Chan, 2011)</span>.</p></li>
<li><p>There are cases in which some variables are measured by
meaningful units and do not need to be standardized. for example, if
<code>cov1</code> is age measured by year, then age is more meaningful
than “standardized age”.</p></li>
<li><p>In regression models, categorical variables are usually
represented by dummy variables, each of them having only two possible
values (0 or 1). It is not meaningful to standardize the dummy
variables.</p></li>
</ul>
</div>
<div id="beta-select-by-glm_betaselect" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Beta-Select by
<code>glm_betaselect()</code></h1>
<p>The function <code>glm_betaselect()</code> can be used to solve these
problems by:</p>
<ul>
<li><p>standardizing variables before product terms are formed,</p></li>
<li><p>standardizing only variables for which standardization can
facilitate interpretation, and</p></li>
<li><p>forming bootstrap confidence intervals that take into account
selected standardization.</p></li>
</ul>
<p>We call the coefficients computed by this kind of standardization
<em>beta</em>s-select (<span class="math inline">\(\beta{s}_{Select}\)</span>, <span class="math inline">\(\beta_{Select}\)</span> in singular form), to
differentiate them from coefficients computed by standardizing all
variables, including product terms.</p>
<div id="estimates-only" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Estimates Only</h2>
<p>Suppose we only need to solve the first problem, standardizing all
numeric variables except for the response variable (which is binary),
with the product term computed after <code>iv</code> and
<code>mod</code> are standardized.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>glm_beta_select <span class="ot">&lt;-</span> <span class="fu">glm_betaselect</span>(dv <span class="sc">~</span> iv<span class="sc">*</span>mod <span class="sc">+</span> cov1 <span class="sc">+</span> cat1,</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>                                  <span class="at">data =</span> data_test_mod_cat_binary,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                                  <span class="at">skip_response =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>                                  <span class="at">family =</span> <span class="fu">binomial</span>(),</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>                                  <span class="at">do_boot =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>The function <code>glm_beta_iv_mod()</code> can be used as
<code>glm()</code>, with applicable arguments such as the model formula
and <code>data</code> passed to <code>glm()</code>.</p>
<p>By default, <em>all</em> numeric variables will be standardized
before fitting the models. Terms such as product terms are created
<em>after</em> standardization.</p>
<p>For <code>glm()</code>, standardizing the outcome variable
(<code>dv</code> in this example) may not be meaningful or may even be
not allowed. In the case of logistic regression, the outcome variable
need to be 0 or 1 only. Therefore, <code>skip_response</code> is set to
<code>TRUE</code>, to request that the response (outcome) variable is
<em>not</em> standardized.</p>
<p>Moreover, categorical variables (factors and string variables) will
not be standardized.</p>
<p>Bootstrapping is done by default. In this illustration,
<code>do_boot = FALSE</code> is added to disable it because we only want
to address the first problem. We will do bootstrapping when addressing
the issue with confidence intervals.</p>
<p>The <code>summary()</code> method can be used ont the output of
<code>glm_betaselect()</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">summary</span>(glm_beta_select)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; Call to glm_betaselect():</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; betaselectr::lm_betaselect(formula = dv ~ iv * mod + cov1 + cat1, </span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt;     family = binomial(), data = data_test_mod_cat_binary, skip_response = TRUE, </span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt;     do_boot = FALSE, model_call = &quot;glm&quot;)</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; Variable(s) standardized: iv, mod, cov1 </span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; stats::glm(formula = dv ~ iv * mod + cov1 + cat1, family = binomial(), </span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt;     data = betaselectr::std_data(data = data_test_mod_cat_binary, </span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt;         to_standardize = c(&quot;iv&quot;, &quot;mod&quot;, &quot;cov1&quot;)))</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt;             Estimate CI.Lower CI.Upper Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; (Intercept)   -1.158   -1.783   -0.584      0.304  -3.807  &lt; 0.001 ***</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt; iv             0.140   -0.125    0.409      0.136   1.027  0.30449    </span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt; mod            0.194   -0.080    0.474      0.141   1.376  0.16878    </span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt; cov1          -0.046   -0.287    0.193      0.122  -0.376  0.70656    </span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt; cat1gp2        0.890    0.193    1.620      0.363   2.455  0.01410 *  </span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt; cat1gp3        1.283    0.625    1.981      0.344   3.724  &lt; 0.001 ***</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt; iv:mod         0.335    0.108    0.578      0.120   2.797  0.00516 ** </span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 415.03  on 299  degrees of freedom</span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 390.91  on 293  degrees of freedom</span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="co">#&gt; AIC: 404.9</span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a><span class="co">#&gt; Transformed Parameter Estimates:</span></span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a><span class="co">#&gt;             Exp(B) CI.Lower CI.Upper</span></span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.314    0.168    0.558</span></span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a><span class="co">#&gt; iv           1.150    0.882    1.506</span></span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a><span class="co">#&gt; mod          1.214    0.923    1.607</span></span>
<span id="cb9-40"><a href="#cb9-40" tabindex="-1"></a><span class="co">#&gt; cov1         0.955    0.751    1.213</span></span>
<span id="cb9-41"><a href="#cb9-41" tabindex="-1"></a><span class="co">#&gt; cat1gp2      2.435    1.213    5.052</span></span>
<span id="cb9-42"><a href="#cb9-42" tabindex="-1"></a><span class="co">#&gt; cat1gp3      3.607    1.868    7.251</span></span>
<span id="cb9-43"><a href="#cb9-43" tabindex="-1"></a><span class="co">#&gt; iv:mod       1.398    1.114    1.782</span></span>
<span id="cb9-44"><a href="#cb9-44" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-45"><a href="#cb9-45" tabindex="-1"></a><span class="co">#&gt; Note:</span></span>
<span id="cb9-46"><a href="#cb9-46" tabindex="-1"></a><span class="co">#&gt; - Results *after* standardization are reported.</span></span>
<span id="cb9-47"><a href="#cb9-47" tabindex="-1"></a><span class="co">#&gt; - Standard errors are least-squares standard errors.</span></span>
<span id="cb9-48"><a href="#cb9-48" tabindex="-1"></a><span class="co">#&gt; - Z values are computed by &#39;Estimate / Std. Error&#39;.</span></span>
<span id="cb9-49"><a href="#cb9-49" tabindex="-1"></a><span class="co">#&gt; - P-values are usual z-test p-values.</span></span>
<span id="cb9-50"><a href="#cb9-50" tabindex="-1"></a><span class="co">#&gt; - Default standard errors, z values, p-values, and confidence intervals</span></span>
<span id="cb9-51"><a href="#cb9-51" tabindex="-1"></a><span class="co">#&gt;   (if reported) should not be used for coefficients involved in</span></span>
<span id="cb9-52"><a href="#cb9-52" tabindex="-1"></a><span class="co">#&gt;   standardization.</span></span>
<span id="cb9-53"><a href="#cb9-53" tabindex="-1"></a><span class="co">#&gt; - Default 95.0% confidence interval reported.</span></span></code></pre></div>
<p>Compared to the solution with the product term standardized, the
coefficient of <code>iv:mod</code> changed substantially from 5.413 to
0.335. Similar to the case of linear regression <span class="citation">(Cheung et al., 2022)</span>, the coefficient of
<em>standardized</em> product term (<code>iv:mod</code>) can be
substantially different from the properly standardized product term (the
product of standardized <code>iv</code> and standardized
<code>mod</code>).</p>
</div>
<div id="estimates-and-bootstrap-confidence-interval" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Estimates and
Bootstrap Confidence Interval</h2>
<p>Suppose we want to address both the first and the second problems,
with</p>
<ul>
<li><p>the product term computed after <code>iv</code> and
<code>mod</code> are standardized, and</p></li>
<li><p>bootstrap confidence interval used.</p></li>
</ul>
<p>We can call <code>glm_betaselect()</code> again, with additional
arguments set:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>glm_beta_select_boot <span class="ot">&lt;-</span> <span class="fu">glm_betaselect</span>(dv <span class="sc">~</span> iv<span class="sc">*</span>mod <span class="sc">+</span> cov1 <span class="sc">+</span> cat1,</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>                                       <span class="at">data =</span> data_test_mod_cat_binary,</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>                                       <span class="at">family =</span> <span class="fu">binomial</span>(),</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>                                       <span class="at">skip_response =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>                                       <span class="at">bootstrap =</span> <span class="dv">5000</span>,</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>                                       <span class="at">iseed =</span> <span class="dv">4567</span>)</span></code></pre></div>
<p>These are the additional arguments:</p>
<ul>
<li><p><code>bootstrap</code>: The number of bootstrap samples to draw.
Default is 100. It should be set to 5000 or even 10000.</p></li>
<li><p><code>iseed</code>: The seed for the random number generator used
for bootstrapping. Set this to an integer to make the results
reproducible.</p></li>
</ul>
<p>This is the output of <code>summary()</code></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">summary</span>(glm_beta_select_boot)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#&gt; Call to glm_betaselect():</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; betaselectr::lm_betaselect(formula = dv ~ iv * mod + cov1 + cat1, </span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt;     family = binomial(), data = data_test_mod_cat_binary, skip_response = TRUE, </span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt;     bootstrap = 5000, iseed = 4567, model_call = &quot;glm&quot;)</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; Variable(s) standardized: iv, mod, cov1 </span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; stats::glm(formula = dv ~ iv * mod + cov1 + cat1, family = binomial(), </span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt;     data = betaselectr::std_data(data = data_test_mod_cat_binary, </span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt;         to_standardize = c(&quot;iv&quot;, &quot;mod&quot;, &quot;cov1&quot;)))</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt;             Estimate CI.Lower CI.Upper Std. Error z value Pr(Boot)    </span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt; (Intercept)   -1.158   -1.869   -0.598      0.322  -3.598   &lt;0.001 ***</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt; iv             0.140   -0.134    0.420      0.142   0.982    0.336    </span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt; mod            0.194   -0.083    0.486      0.145   1.337    0.169    </span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt; cov1          -0.046   -0.287    0.193      0.122  -0.376    0.699    </span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt; cat1gp2        0.890    0.193    1.722      0.386   2.306    0.012 *  </span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt; cat1gp3        1.283    0.644    2.063      0.362   3.542   &lt;0.001 ***</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co">#&gt; iv:mod         0.335    0.109    0.597      0.124   2.700    0.004 ** </span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 415.03  on 299  degrees of freedom</span></span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 390.91  on 293  degrees of freedom</span></span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a><span class="co">#&gt; AIC: 404.9</span></span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a><span class="co">#&gt; Transformed Parameter Estimates:</span></span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a><span class="co">#&gt;             Exp(B) CI.Lower CI.Upper</span></span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.314    0.154    0.550</span></span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a><span class="co">#&gt; iv           1.150    0.875    1.521</span></span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a><span class="co">#&gt; mod          1.214    0.920    1.625</span></span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a><span class="co">#&gt; cov1         0.955    0.750    1.213</span></span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a><span class="co">#&gt; cat1gp2      2.435    1.213    5.596</span></span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a><span class="co">#&gt; cat1gp3      3.607    1.904    7.867</span></span>
<span id="cb11-42"><a href="#cb11-42" tabindex="-1"></a><span class="co">#&gt; iv:mod       1.398    1.115    1.816</span></span>
<span id="cb11-43"><a href="#cb11-43" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-44"><a href="#cb11-44" tabindex="-1"></a><span class="co">#&gt; Note:</span></span>
<span id="cb11-45"><a href="#cb11-45" tabindex="-1"></a><span class="co">#&gt; - Results *after* standardization are reported.</span></span>
<span id="cb11-46"><a href="#cb11-46" tabindex="-1"></a><span class="co">#&gt; - Nonparametric bootstrapping conducted.</span></span>
<span id="cb11-47"><a href="#cb11-47" tabindex="-1"></a><span class="co">#&gt; - The number of bootstrap samples is 5000.</span></span>
<span id="cb11-48"><a href="#cb11-48" tabindex="-1"></a><span class="co">#&gt; - Standard errors are bootstrap standard errors.</span></span>
<span id="cb11-49"><a href="#cb11-49" tabindex="-1"></a><span class="co">#&gt; - Z values are computed by &#39;Estimate / Std. Error&#39;.</span></span>
<span id="cb11-50"><a href="#cb11-50" tabindex="-1"></a><span class="co">#&gt; - The bootstrap p-values are asymmetric p-values by Asparouhov and</span></span>
<span id="cb11-51"><a href="#cb11-51" tabindex="-1"></a><span class="co">#&gt;   Muthén (2021).</span></span>
<span id="cb11-52"><a href="#cb11-52" tabindex="-1"></a><span class="co">#&gt; - Percentile bootstrap 95.0% confidence interval reported.</span></span></code></pre></div>
<p>By default, 95% percentile bootstrap confidence intervals are printed
(<code>CI.Lower</code> and <code>CI.Upper</code>). The <em>p</em>-values
(<code>Pr(Boot)</code>) are asymmetric bootstrap <em>p</em>-values <span class="citation">(Asparouhov &amp; Muthén, 2021)</span>.</p>
</div>
<div id="estimates-and-bootstrap-confidence-intervals-with-only-selected-variables-standardized" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Estimates and
Bootstrap Confidence Intervals, With Only Selected Variables
Standardized</h2>
<p>Suppose we want to address also the the third issue, and standardize
only some of the variables. This can be done using either
<code>to_standardize</code> or <code>not_to_standardize</code>.</p>
<ul>
<li><p>Use <code>to_standardize</code> when the number of variables to
standardize is much fewer than number of the variables not to
standardize</p></li>
<li><p>Use <code>not_to_standardize</code> when the number of variables
to standardize is much more than the number of variables not to
standardize.</p></li>
</ul>
<p>For example, suppose we only need to standardize <code>iv</code> and
<code>cov1</code>, this is the call to do this, setting
<code>to_standardize</code> to <code>c(&quot;iv&quot;, &quot;cov1&quot;)</code>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>glm_beta_select_boot_1 <span class="ot">&lt;-</span> <span class="fu">glm_betaselect</span>(dv <span class="sc">~</span> iv<span class="sc">*</span>mod <span class="sc">+</span> cov1 <span class="sc">+</span> cat1,</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>                                         <span class="at">data =</span> data_test_mod_cat_binary,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>                                         <span class="at">to_standardize =</span> <span class="fu">c</span>(<span class="st">&quot;iv&quot;</span>, <span class="st">&quot;cov1&quot;</span>),</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>                                         <span class="at">skip_response =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>                                         <span class="at">family =</span> <span class="fu">binomial</span>(),</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>                                         <span class="at">bootstrap =</span> <span class="dv">5000</span>,</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>                                         <span class="at">iseed =</span> <span class="dv">4567</span>)</span></code></pre></div>
<p>If we want to standardize all variables except for <code>mod</code>
(<code>dv</code> is skipped by <code>skip_response</code>) we can use
this call, and set <code>not_to_standardize</code> to
<code>&quot;mod&quot;</code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>glm_beta_select_boot_2 <span class="ot">&lt;-</span> <span class="fu">glm_betaselect</span>(dv <span class="sc">~</span> iv<span class="sc">*</span>mod <span class="sc">+</span> cov1 <span class="sc">+</span> cat1,</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>                                         <span class="at">data =</span> data_test_mod_cat_binary,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>                                         <span class="at">not_to_standardize =</span> <span class="fu">c</span>(<span class="st">&quot;mod&quot;</span>),</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>                                         <span class="at">skip_response =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>                                         <span class="at">family =</span> <span class="fu">binomial</span>(),</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>                                         <span class="at">bootstrap =</span> <span class="dv">5000</span>,</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>                                         <span class="at">iseed =</span> <span class="dv">4567</span>)</span></code></pre></div>
<p>The results of these calls are identical, and only those of the first
version are printed:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">summary</span>(glm_beta_select_boot_1)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#&gt; Call to glm_betaselect():</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#&gt; betaselectr::lm_betaselect(formula = dv ~ iv * mod + cov1 + cat1, </span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">#&gt;     family = binomial(), data = data_test_mod_cat_binary, to_standardize = c(&quot;iv&quot;, </span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt;         &quot;cov1&quot;), skip_response = TRUE, bootstrap = 5000, iseed = 4567, </span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt;     model_call = &quot;glm&quot;)</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt; Variable(s) standardized: iv, cov1 </span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt; stats::glm(formula = dv ~ iv * mod + cov1 + cat1, family = binomial(), </span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt;     data = betaselectr::std_data(data = data_test_mod_cat_binary, </span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt;         to_standardize = c(&quot;iv&quot;, &quot;cov1&quot;)))</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt;             Estimate CI.Lower CI.Upper Std. Error z value Pr(Boot)    </span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt; (Intercept)   -3.460   -7.063   -0.061      1.798  -1.924   0.0460 *  </span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt; iv            -3.832   -6.807   -1.171      1.431  -2.678   0.0044 ** </span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt; mod            0.046   -0.020    0.115      0.035   1.339   0.1692    </span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt; cov1          -0.046   -0.287    0.193      0.122  -0.376   0.6988    </span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt; cat1gp2        0.890    0.193    1.722      0.386   2.306   0.0120 *  </span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt; cat1gp3        1.283    0.644    2.063      0.362   3.542   &lt;0.001 ***</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co">#&gt; iv:mod         0.080    0.027    0.140      0.029   2.767   0.0040 ** </span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 415.03  on 299  degrees of freedom</span></span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 390.91  on 293  degrees of freedom</span></span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a><span class="co">#&gt; AIC: 404.9</span></span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a><span class="co">#&gt; Transformed Parameter Estimates:</span></span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a><span class="co">#&gt;             Exp(B) CI.Lower CI.Upper</span></span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.031    0.001    0.941</span></span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a><span class="co">#&gt; iv           0.022    0.001    0.310</span></span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a><span class="co">#&gt; mod          1.047    0.980    1.122</span></span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a><span class="co">#&gt; cov1         0.955    0.750    1.213</span></span>
<span id="cb14-41"><a href="#cb14-41" tabindex="-1"></a><span class="co">#&gt; cat1gp2      2.435    1.213    5.596</span></span>
<span id="cb14-42"><a href="#cb14-42" tabindex="-1"></a><span class="co">#&gt; cat1gp3      3.607    1.904    7.867</span></span>
<span id="cb14-43"><a href="#cb14-43" tabindex="-1"></a><span class="co">#&gt; iv:mod       1.083    1.027    1.150</span></span>
<span id="cb14-44"><a href="#cb14-44" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-45"><a href="#cb14-45" tabindex="-1"></a><span class="co">#&gt; Note:</span></span>
<span id="cb14-46"><a href="#cb14-46" tabindex="-1"></a><span class="co">#&gt; - Results *after* standardization are reported.</span></span>
<span id="cb14-47"><a href="#cb14-47" tabindex="-1"></a><span class="co">#&gt; - Nonparametric bootstrapping conducted.</span></span>
<span id="cb14-48"><a href="#cb14-48" tabindex="-1"></a><span class="co">#&gt; - The number of bootstrap samples is 5000.</span></span>
<span id="cb14-49"><a href="#cb14-49" tabindex="-1"></a><span class="co">#&gt; - Standard errors are bootstrap standard errors.</span></span>
<span id="cb14-50"><a href="#cb14-50" tabindex="-1"></a><span class="co">#&gt; - Z values are computed by &#39;Estimate / Std. Error&#39;.</span></span>
<span id="cb14-51"><a href="#cb14-51" tabindex="-1"></a><span class="co">#&gt; - The bootstrap p-values are asymmetric p-values by Asparouhov and</span></span>
<span id="cb14-52"><a href="#cb14-52" tabindex="-1"></a><span class="co">#&gt;   Muthén (2021).</span></span>
<span id="cb14-53"><a href="#cb14-53" tabindex="-1"></a><span class="co">#&gt; - Percentile bootstrap 95.0% confidence interval reported.</span></span></code></pre></div>
<p>For <em>beta</em>s-<em>select</em>, researchers need to state which
variables are standardized and which are not. This can be done in table
notes.</p>
</div>
<div id="categorical-variables" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Categorical
Variables</h2>
<p>When calling <code>glm_betaselect()</code>, categorical variables
(factors and string variables) will never be standardized.</p>
<p>In the example above, the coefficients of the two dummy variables
when both the dummy variables and the outcome variables are standardized
are 0.416 and 0.642:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">printCoefmat</span>(glm_std_common_summary<span class="sc">$</span>coefficients[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>, ],</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>             <span class="at">digits =</span> <span class="dv">5</span>,</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>             <span class="at">zap.ind =</span> <span class="dv">1</span>,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>             <span class="at">P.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>             <span class="at">has.Pvalue =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>             <span class="at">signif.stars =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt;         Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; cat_gp2  0.41587    0.16941  2.4547 0.014100 *  </span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; cat_gp3  0.64201    0.17239  3.7242 0.000196 ***</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>These two values are not interpretable because it does not make sense
to talk about a “one-SD change” in the dummy variables.</p>
</div>
</div>
<div id="conclusion" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Conclusion</h1>
<p>In generalized linear modeling, there are many situations in which
standardizing all variables is not appropriate, or when standardization
needs to be done before forming product terms. We are not aware of tools
that can do appropriate standardization <em>and</em> form confidence
intervals that takes into account the selective standardization. By
promoting the use of <em>beta</em>s-<em>select</em> using
<code>glm_betaselect()</code>, we hope to make it easier for researchers
to do appropriate standardization when reporting generalized linear
modeling results.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-asparouhov_bootstrap_2021" class="csl-entry">
Asparouhov, T., &amp; Muthén, B. O. (2021). <em>Bootstrap
<em>p</em>-value computation</em>. <a href="https://www.statmodel.com/download/FAQ-Bootstrap%20-%20Pvalue.pdf">https://www.statmodel.com/download/FAQ-Bootstrap%20-%20Pvalue.pdf</a>
</div>
<div id="ref-cheung_improving_2022" class="csl-entry">
Cheung, S. F., Cheung, S.-H., Lau, E. Y. Y., Hui, C. H., &amp; Vong, W.
N. (2022). Improving an old way to measure moderation effect in
standardized units. <em>Health Psychology</em>, <em>41</em>(7), 502–505.
<a href="https://doi.org/10.1037/hea0001188">https://doi.org/10.1037/hea0001188</a>
</div>
<div id="ref-friedrich_defense_1982" class="csl-entry">
Friedrich, R. J. (1982). In defense of multiplicative terms in multiple
regression equations. <em>American Journal of Political Science</em>,
<em>26</em>(4), 797–833. <a href="https://doi.org/10.2307/2110973">https://doi.org/10.2307/2110973</a>
</div>
<div id="ref-menard_six_2004" class="csl-entry">
Menard, S. (2004). Six approaches to calculating standardized logistic
regression coefficients. <em>The American Statistician</em>,
<em>58</em>(3), 218–223. <a href="https://doi.org/10.1198/000313004X946">https://doi.org/10.1198/000313004X946</a>
</div>
<div id="ref-yuan_biases_2011" class="csl-entry">
Yuan, K.-H., &amp; Chan, W. (2011). Biases and standard errors of
standardized regression coefficients. <em>Psychometrika</em>,
<em>76</em>(4), 670–690. <a href="https://doi.org/10.1007/s11336-011-9224-6">https://doi.org/10.1007/s11336-011-9224-6</a>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
